---
title: "Adding a table of contents"
author: "Mitch"
date: "2020-05-13"
output:
  html_notebook:
    toc: true
---



<div id="adding-a-table-of-contents" class="section level2">
<h2>Adding a table of contents</h2>
<p>I am very new to building websites and while there are excellent tutorials on how to get one up and running using r (check out <a href="https://bookdown.org/yihui/blogdown/">Yihui’s book</a> and <a href="https://annielyu.com/2020/01/12/blogdown-website/">this great tutorial by Annie Lyu</a>), something that was bugging me from an aesthetic perspective was the lack of a table of contents. I know in r markdown this is as easily obtained by adding the following:</p>
<pre class="r"><code># ---
# title: &quot;My title!&quot;
# output:
#   html_document:
#     toc: true</code></pre>
<p>However, I noticed that when trying to do the same on my academic theme from Hugo, it wasn’t working.</p>
<p>I am currently trying to find a workaround to this. First we’ll go into themes/hugo-academic/layouts/partials/docs_toc_foot.html and add the following;</p>
<pre class="r"><code># &lt;div class=&quot;connect-widget&quot;&gt;
#   &lt;ul class=&quot;connect-links fa-ul&quot;&gt;
#     &lt;li&gt;&lt;i class=&quot;fa-li fas fa-question-circle&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://spectrum.chat/academic&quot; target=&quot;_blank&quot;&gt;Ask questions&lt;/a&gt;&lt;/li&gt;
#     &lt;li&gt;&lt;i class=&quot;fa-li fas fa-comments&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://github.com/gcushen/hugo-academic/issues&quot; target=&quot;_blank&quot;&gt;Request features&lt;/a&gt;&lt;/li&gt;
#     &lt;li&gt;&lt;i class=&quot;fa-li fas fa-bug&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://github.com/gcushen/hugo-academic/issues&quot; target=&quot;_blank&quot;&gt;Report issues&lt;/a&gt;&lt;/li&gt;
#   &lt;/ul&gt;
# &lt;/div&gt;</code></pre>
<p>And add while still in /partials/ folder we’re going to create a new html file called toc.html and copy the following.</p>
<pre class="r"><code># {{ $headers := findRE &quot;&lt;h[1-3].*?&gt;(.|\n])+?&lt;/h[1-3]&gt;&quot; .Content }}
# {{ $has_headers := ge (len $headers) 1 }}
# {{ if $has_headers }}
# &lt;nav id=&quot;toc&quot; data-toggle=&quot;toc&quot;&gt;
#   &lt;h4 class=&quot;text-muted&quot;&gt;Contents&lt;/h4&gt;
#   &lt;ul class=&quot;nav&quot;&gt;
#     {{ range $i, $header := $headers }}
#       {{ $header_level := index (findRE &quot;[1-3]&quot; . 1) 0 }}
#       {{ $header_level := len (seq $header_level) }}
# 
#       {{ $hash := index (findRE &quot;id=.([^\&quot;]+).&quot; $header 1) 0 }}
#       {{ $hash := replace $hash &quot;id=\&quot;&quot; &quot;&quot; }}
#       {{ $hash := replace $hash &quot;\&quot;&quot; &quot;&quot; }}
# 
#       {{ if ne $i 0 }}
#         {{ $previous_level := index (findRE &quot;[1-3]&quot; (index $headers (sub $i 1)) 1) 0 }}
#         {{ $previous_level := len (seq $previous_level) }}
# 
#         {{ if gt $header_level $previous_level }}
#           {{ range seq (sub $header_level $previous_level) }}
#           &lt;ul class=&quot;nav&quot;&gt;
#           {{ end }}
#         {{ end }}
# 
#         {{ if lt $header_level $previous_level }}
#           {{ range seq (sub $previous_level $header_level) }}
#           &lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;
#           {{ end }}
#         {{ end }}
# 
#         {{ if eq $header_level $previous_level }}
#           &lt;/li&gt;
#         {{ end }}
# 
#         &lt;li&gt;
#           &lt;a href=&quot;#{{ $hash }}&quot;&gt;{{ $header | plainify | safeHTML }}&lt;/a&gt;
# 
#         {{ if eq $i (sub (len $headers) 1) }}
#           {{ range seq (sub $previous_level $header_level) }}
#           &lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;
#           {{ end }}
#         {{ end }}
# 
#       {{ else }}
# 
#       &lt;li&gt;
#         &lt;a href=&quot;#{{ $hash }}&quot;&gt;{{ $header | plainify | safeHTML }}&lt;/a&gt;
# 
#       {{end}}
#     {{end}}
# 
#     {{ $first_level := len (seq (index (findRE &quot;[1-3]&quot; (index $headers 0) 1) 0)) }}
#     {{ $last_level := len (seq (index (findRE &quot;[1-3]&quot; (index $headers (sub (len $headers) 1)) 1) 0)) }}
#     {{ range seq (sub $last_level $first_level) }}
#       &lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;
#     {{end}}
# 
#   &lt;/ul&gt;
# &lt;/nav&gt;
# {{end}}</code></pre>
</div>
